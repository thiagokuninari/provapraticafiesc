-- ADICIONA NOVO CARGO PARA SUPERVISOR BACKOFFICE PARA USUARIO AGENTE AUTORIZADO

-- CRIA CARGO NO AUTENTICACAO
INSERT INTO CARGO (ID, CODIGO, NOME, SITUACAO, FK_NIVEL, QUANTIDADE_SUPERIOR) VALUES (SEQ_CARGO.nextval, 'AGENTE_AUTORIZADO_SUPERVISOR_BACKOFFICE', 'Supervisor BackOffice', 'A', 3, 50);

-- ADICIONA AS MESMAS PERMISSOES DO CARGO AGENTE_AUTORIZADO_SUPERVISOR
DECLARE CARGO_ID INT;

BEGIN
    SELECT ID INTO CARGO_ID FROM CARGO WHERE CODIGO = 'AGENTE_AUTORIZADO_SUPERVISOR_BACKOFFICE';

    FOR C IN (
        SELECT DISTINCT FK_FUNCIONALIDADE, FK_DEPARTAMENTO
        FROM CARGO_DEPART_FUNC
        WHERE FK_CARGO = (
            SELECT ID
            FROM CARGO
            WHERE CODIGO = 'AGENTE_AUTORIZADO_SUPERVISOR'
        )
    ) LOOP
        INSERT INTO CARGO_DEPART_FUNC (ID, FK_CARGO, FK_FUNCIONALIDADE, FK_DEPARTAMENTO) VALUES (SEQ_CARGO_DEPART_FUNC.NEXTVAL, CARGO_ID, C.FK_FUNCIONALIDADE, C.FK_DEPARTAMENTO);
    END LOOP;
END;